# HYPERRSI 매매 점검 항목

## 기본 흐름

1. 매매 시작
2. RSI 신호 발생하면 진입
3. TP/SL 주문 자동 생성
4. 목표 도달하면 자동 청산
5. 매매 중지

---

## 점검 항목

### 1. 진입 확인

**RSI 과매도 시 롱 진입**
- RSI 30 이하 되면 롱 포지션 생성되는지
- 텔레그램 진입 알림 오는지
- 포지션 크기 = 투자금 x 레버리지 맞는지

**RSI 과매수 시 숏 진입**
- RSI 70 이상 되면 숏 포지션 생성되는지
- 텔레그램 진입 알림 오는지

**방향 설정 확인**
- 설정이 "롱"이면 롱만 진입하는지
- 설정이 "숏"이면 숏만 진입하는지
- 설정이 "롱숏"이면 양쪽 다 진입하는지

**포지션 크기 확인**
- 투자금 10 USDT, 레버리지 10배 = 100 USDT 포지션인지
- 최소 200 USDT 미만이면 진입 안되고 오류 나는지

---

### 2. 익절 확인

**TP1 익절**
- 설정: tp1_value = 2.0 (2% 익절)
- 롱: 진입가 100이면 102 도달 시 일부 청산되는지
- 숏: 진입가 100이면 98 도달 시 일부 청산되는지
- 텔레그램 익절 알림 오는지

**TP2 익절**
- 설정: tp2_value = 4.0 (4% 익절)
- 롱: 진입가 100이면 104 도달 시 나머지 청산되는지
- 숏: 진입가 100이면 96 도달 시 나머지 청산되는지
- 텔레그램 최종 익절 알림 오는지

---

### 3. 손절 확인

**SL 손절**
- 설정: sl_value = 1.5 (1.5% 손절)
- 롱: 진입가 100이면 98.5 도달 시 즉시 전체 청산되는지
- 숏: 진입가 100이면 101.5 도달 시 즉시 전체 청산되는지
- 텔레그램 손절 알림 오는지

---

### 4. 설정값 적용 확인

**레버리지**
- 설정에서 레버리지 10으로 설정하면 실제 10배로 진입하는지
- 포지션 있을 때 레버리지 변경하면 "변경 불가" 메시지 나오는지
- 포지션 없을 때 레버리지 변경하면 다음 진입부터 적용되는지

**익절/손절 비율**
- tp1_value, tp2_value, sl_value 변경하면 실제 가격 계산 바뀌는지

**RSI 임계값**
- rsi_oversold = 30 → RSI 30 이하에서 롱 진입하는지
- rsi_overbought = 70 → RSI 70 이상에서 숏 진입하는지

---

### 5. 쿨다운 확인

**쿨다운 켜져있을 때 (use_cooldown: true)**
- 포지션 청산 후 5분간 새로 진입 안하는지
- 5분 지나면 다시 진입하는지

**쿨다운 꺼져있을 때 (use_cooldown: false)**
- 청산 직후 바로 재진입 가능한지

---

### 6. 오류 처리 확인

**잔고 부족**
- 잔고 부족하면 진입 안되고 오류 메시지 나오는지
- 텔레그램 오류 알림 오는지

**최소 주문 금액**
- 투자금 x 레버리지 < 200 USDT 이면 오류 나는지
- 현재값/필요값 표시되는지

**API 오류**
- OKX 연결 끊기면 재시도하는지
- 여러번 실패하면 중지되는지

---

### 7. 텔레그램 알림 확인

**시작 알림**
- 심볼, 타임프레임, 투자금, 레버리지 정보 표시되는지

**진입 알림**
- 롱/숏 방향 표시되는지
- 진입가, 포지션 크기 표시되는지

**청산 알림**
- TP1/TP2/SL 구분되는지
- 청산 가격, 수익/손실 표시되는지

**오류 알림**
- 어떤 오류인지 명확하게 표시되는지

---

## 실제 테스트 방법

### 준비
1. 서버 실행: http://localhost:8000
2. Swagger 접속: http://localhost:8000/docs
3. 잔고 100 USDT 이상 준비

### 기본 테스트 (30분)

**1단계: 설정 확인**
```
GET /api/settings/{user_id}
- 레버리지: 5
- 방향: 롱숏
- tp1_value: 2.0
- sl_value: 1.5
```

**2단계: 매매 시작**
```
POST /api/trading/start
{
  "user_id": "본인ID",
  "symbol": "SOL-USDT-SWAP",
  "timeframe": "1m"
}
```

**3단계: 포지션 확인 (매 2-5분)**
```
GET /api/account/positions?user_id=본인ID
```

**4단계: 매매 중지**
```
POST /api/trading/stop
{
  "user_id": "본인ID"
}
```

---

## 확인 시나리오

### 시나리오 1: 롱 진입 → TP1 청산

1. 매매 시작
2. RSI 30 이하 될 때까지 대기 (5-30분)
3. 롱 포지션 생성 확인
   - 텔레그램 알림 확인
   - 포지션 크기 확인
4. 가격 상승 대기
5. TP1 (+2%) 도달하면 일부 청산 확인
   - 텔레그램 익절 알림
   - 잔량 포지션 유지

### 시나리오 2: 롱 진입 → SL 청산

1. 매매 시작
2. 롱 포지션 진입
3. 가격 하락
4. SL (-1.5%) 도달하면 전체 청산 확인
   - 텔레그램 손절 알림
   - 포지션 완전 청산

### 시나리오 3: 쿨다운 테스트

1. 매매 시작 (use_cooldown: true)
2. 포지션 진입 → 청산
3. 바로 진입 조건 충족해도 5분간 진입 안함 확인
4. 5분 후 정상 진입 확인

---

## 주의사항

실거래 테스트 시
- 소액으로만 진행 (100-200 USDT)
- 레버리지 낮게 (3-5배)
- 쿨다운 켜기
- 이상 동작 시 즉시 중지

---

버전: 1.0.0
최종 업데이트: 2025-01-15
